 File: tests/sample-test.json

{
  "id": "test1",
  "title": "IELTS Reading Practice Test 1",
  "description": "Passage about renewable energy.",
  "sections": [
    {
      "title": "Section 1",
      "passage": "Renewable energy sources like solar and wind are becoming more common...",
      "questions": [
        {
          "number": 1,
          "type": "multiple-choice",
          "question": "Which of the following is a renewable energy source?",
          "options": ["Coal", "Gasoline", "Wind", "Diesel"],
          "answer": "Wind"
        },
        {
          "number": 2,
          "type": "multiple-choice",
          "question": "Why are renewable sources considered sustainable?",
          "opt
document.getElementById('submit-btn').onclick = () => {
    localStorage.setItem('userAnswers', JSON.stringify(userAnswers));
    window.location.href = 'review.html';
  };
}

function renderPassageAndQuestions(test) {
  const passagePane = document.getElementById('passage-pane');
  const questionsPane = document.getElementById('questions-pane');
  const nav = document.getElementById('navigation-controls');

  test.sections.forEach((section, i) => {
    passagePane.innerHTML += `<h2>${section.title}</h2><p>${section.passage}</p>`;

    section.questions.forEach(q => {
      const qDiv = document.createElement('div');
      qDiv.className = 'question-card';
      qDiv.innerHTML = `
        <p><strong>Q${q.number}</strong>: ${q.question}</p>
        ${q.options.map(opt => `
          <label><input type="radio" name="q${q.number}" value="${opt}" 
            onchange="userAnswers[${q.number}] = '${opt}'" /> ${opt}</label><br/>`
        ).join('')}
      `;
      questionsPane.appendChild(qDiv);
    });
  });
}

function startTimer(seconds) {
  const container = document.getElementById('timer-container');
  timer = setInterval(() => {
    if (seconds <= 0) {
      clearInterval(timer);
      alert("Time's up!");
      document.getElementById('submit-btn').click();
    } else {
      container.textContent = `Time Left: ${Math.floor(seconds / 60)}:${(seconds % 60).toString().padStart(2, '0')}`;
      seconds--;
    }
  }, 1000);
}

// ----------------- REVIEW PAGE -----------------
async function showReview() {
  const file = localStorage.getItem('currentTestFile');
  const test = await fetch(testFolder + file).then(res => res.json());
  const answers = JSON.parse(localStorage.getItem('userAnswers'));
  const bandMap = await fetch(bandMapUrl).then(res => res.json());
  const reviewDiv = document.getElementById('review-container');

  let totalCorrect = 0;
  reviewDiv.innerHTML = '';

  test.sections.forEach(section => {
    section.questions.forEach(q => {
      const userAnswer = answers[q.number];
      const isCorrect = userAnswer === q.answer;
      if (isCorrect) totalCorrect++;
      const div = document.createElement('div');
      div.className = `question-card ${isCorrect ? 'correct-answer' : 'incorrect-answer'}`;
      div.innerHTML = `
        <p><strong>Q${q.number}:</strong> ${q.question}</p>
        <p>Your answer: <strong>${userAnswer || 'N/A'}</strong></p>
        ${!isCorrect ? `<p>Correct answer: <strong>${q.answer}</strong></p>` : ''}
      `;
      reviewDiv.appendChild(div);
    });
  });

  const bandScore = bandMap[totalCorrect] || 'N/A';
  const summary = document.createElement('div');
  summary.innerHTML = `<h2>Score Summary</h2>
    <p>Total Correct: ${totalCorrect}</p>
    <p>Estimated IELTS Band: <strong>${bandScore}</strong></p>`;
  reviewDiv.prepend(summary);

  document.getElementById('retake-btn').onclick = () => {
    localStorage.removeItem('userAnswers');
    window.location.href = 'test.html';
  };
}
